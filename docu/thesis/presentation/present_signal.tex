% --
% intro

\section{Signal Processing and Feature Extraction}
\sectionheader{Signal Processing and Feature Extraction}
\begin{frame}
  \frametitle{Speech Signal}
  \begin{itemize}
    \item Signal with $N$ samples
    \begin{equation*}\label{eq:signal_raw_x}
      \footnotesize
      \bm{x} = [x_0, x_1, \dots, x_{N-1}]^T
    \end{equation*}
  \end{itemize}
  \begin{figure} \includegraphics[width=0.65\textwidth]{../3_signal/figs/signal_raw_showcase_right0.png} \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Spectral Features}
  \vspace{-0.5cm}
  \begin{itemize}
    \item Discrete Fourier Transform (DFT):
    \begin{equation*}\label{eq:signal_spec_dtft_matrix}
      \footnotesize
      \begin{aligned}
        \hat{\bm{x}} = \mathcal{F} \bm{x} \quad & \mathrm{with} 
        \quad \mathcal{F}[k, n] = e^{-j\frac{2 \pi n}{N} k},\\
        &k, n = (0, 1, \dots, K-1), (0, 1, \dots, N-1)
      \end{aligned}
    \end{equation*}

    \item Short-Time Fourier Transform (STFT):
    \begin{equation*}\label{eq:signal_spec_stft}
      \footnotesize
      \begin{aligned}
        \tilde{X}[k, m] &= \sum_{n=0}^{N-1} x[n + m h] \, w[n] \, e^{-j\frac{2 \pi n}{N}k},\\ 
        m &= 0, 1, \dots, M - 1,\\
        M &= \ceil*{\frac{\norm{\bm{x}}_0-N}{h}}
      \end{aligned}
    \end{equation*}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Spectral Features}
  \vspace{-0.5cm}
  \begin{itemize}
    \item Spectrogram:
    \begin{equation*}
      \footnotesize
      P = \abs{\tilde{X}}^2
    \end{equation*}
  \end{itemize}
  \begin{figure} \includegraphics[width=0.65\textwidth]{../3_signal/figs/signal_spec-lin_showcase_right0.png} \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Spectral Features}
  \vspace{-0.5cm}
  \begin{itemize}
    \item logarithmic Spectrogram:
    \begin{equation*}
      \footnotesize
      P_{DB} = 10 \cdot \log_{10}{P}
    \end{equation*}
  \end{itemize}
  \begin{figure} \includegraphics[width=0.65\textwidth]{../3_signal/figs/signal_spec-log_showcase_right0.png} \end{figure}
\end{frame}

\begin{frame}
  \frametitle{MFCC Features}
  \vspace{-0.5cm}
  \begin{itemize}
    \item MFCC:
    \begin{equation*}
      \footnotesize
      U = \mathcal{D} \log{ \left( W_m   P \right) }
    \end{equation*}
  \end{itemize}
  \begin{figure}
    \centering
    \subfigure[DCT ($\mathcal{D}$)]{\includegraphics[width=0.45\textwidth]{../3_signal/figs/signal_mfcc_dct.png}}
    \subfigure[Mel Bands ($W_m$)]{\includegraphics[width=0.5\textwidth]{../3_signal/figs/signal_mfcc_weights_f.png}}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{MFCC Features}
  \vspace{-1cm}
  \begin{itemize}
    \item Frame based normalization:
    \begin{equation*}
      \scriptsize
      \begin{aligned}
        &U[c, m] \gets \frac{U[c, m] + \vert \underset{m \in \mathcal{M}}{\min} \bm{u}_c \vert}{\norm{\bm{u}_c + \vert \underset{m \in \mathcal{M}}{\min} \bm{u}_c \vert}_\infty}\\
        & \forall \, c, m = (0, 1, \dots, C - 1), (0, 1, \dots, M - 1)
      \end{aligned}
    \end{equation*}
  \end{itemize}
  \vspace{-0.25cm}
  \begin{figure} \includegraphics[width=0.65\textwidth]{../3_signal/figs/signal_mfcc_showcase_mfcc32_right0.png} \end{figure}
\end{frame}

\begin{frame}
  \frametitle{MFCC Feature Enhancements}
  \vspace{-1cm}
  \begin{itemize}
    \item Delta- and Double Delta features:
    \begin{equation*}
      \scriptsize
      \Delta u_c[m] = \frac{u_c[m - 1] + u_c[m + 1]}{2}
    \end{equation*}
    \item Energy features:
    \begin{equation*}
      \scriptsize
      e[m] = \bm{u}[m]^T \bm{u}[m]
    \end{equation*}
  \end{itemize}
  \begin{figure} \includegraphics[width=0.65\textwidth]{../3_signal/figs/signal_mfcc_showcase_mfcc39_right0.png} \end{figure}
\end{frame}

\begin{frame}
  \frametitle{MFCC Computations}
  \vspace{-1cm}
  \begin{itemize}
    \item Signal: \SI{1}{\second} with $f_s = \SI{16}{\kilo\hertz}$.
    \item STFT and MFCC:
    \vspace{-0.1cm}
    \begin{itemize}
      \footnotesize
      \item \SI{25}{\milli\second} Analytical window with \SI{10}{\milli\second} hop,
      \item $K = 400$ Fourier coefficients,
      \item $B = 32$ filter bands and 
      \item $C=12$ cepstral coefficients.
    \end{itemize}
  \end{itemize}
  \vspace{-0.5cm}
  \include{./tables/present_tab_signal_mfcc_operations.tex}
\end{frame}


\begin{frame}
  \frametitle{Onset Detection}
  \vspace{-0.75cm}
  \begin{itemize}
    \item Two kinds of onset detection method:
    \begin{itemize}
      \item Keyword onset detection:
        \begin{itemize}
          \item used in order to find exact start of keyword in audiofile
          \item applied for the extraction of data examples of restricted time length (\SI{500}{\milli\second}).
        \end{itemize}
      \item Online onset detection:
        \begin{itemize}
          \item applied in the game to indicate whether a keyword is present.
          \begin{equation*}
          %\scriptsize
            o(\bm{x}) = 
            \begin{cases}
              1, & \text{if } \frac{1}{n} \bm{x}^T \bm{x} > \alpha\\
              0, & \text{otherwise} 
            \end{cases},
          \end{equation*}
        \end{itemize}
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Keyword Onset Detection}
  \vspace{-1cm}
  \begin{equation*}
  \scriptsize
    \begin{aligned}
      e[m] &= \sum_{i=0}^{N-1} \abs{x[m + i]}^2, \quad \mathrm{or} \quad e[m] = \sum_{i=0}^{N-1} u_0[m + i],\\
      o &= \underset{m \in \mathcal{M}}{\arg \max} \, e[m]
    \end{aligned}
  \end{equation*}
  \begin{figure} \hspace{0.75cm} \includegraphics[width=0.55\textwidth]{../3_signal/figs/signal_onset_window.pdf} \end{figure}
  \begin{figure} \includegraphics[width=0.55\textwidth]{../3_signal/figs/signal_onset_showcase_right0.png} \end{figure}
\end{frame}